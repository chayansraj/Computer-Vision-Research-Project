2022-12-15 09:40:49.409332: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.10.1
/home/chash345/.conda/envs/research/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: /home/chash345/.conda/envs/research/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE
  warn(f"Failed to load image Python extension: {e}")
Resolving data files:   0%|          | 0/2600 [00:00<?, ?it/s]Resolving data files:  53%|█████▎    | 1370/2600 [00:00<00:00, 12498.99it/s]Resolving data files: 100%|██████████| 2600/2600 [00:00<00:00, 14092.40it/s]
Using custom data configuration train-5ba040123c4f7080
Found cached dataset imagefolder (/home/chash345/.cache/huggingface/datasets/imagefolder/train-5ba040123c4f7080/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 52.28it/s]
Resolving data files:   0%|          | 0/870 [00:00<?, ?it/s]Resolving data files: 100%|██████████| 870/870 [00:00<00:00, 30432.80it/s]
Using custom data configuration valid-1603420759c35bdb
Found cached dataset imagefolder (/home/chash345/.cache/huggingface/datasets/imagefolder/valid-1603420759c35bdb/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 235.56it/s]
Resolving data files:   0%|          | 0/864 [00:00<?, ?it/s]Resolving data files: 100%|██████████| 864/864 [00:00<00:00, 25835.02it/s]
Using custom data configuration test-1f68a239285f9c45
Found cached dataset imagefolder (/home/chash345/.cache/huggingface/datasets/imagefolder/test-1f68a239285f9c45/0.0.0/37fbb85cc714a338bea574ac6c7d0b5be5aff46c1862c1989b20e0771199e93f)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 210.60it/s]
Some weights of the model checkpoint at google/vit-base-patch16-224-in21k were not used when initializing ViTForImageClassification: ['pooler.dense.bias', 'pooler.dense.weight']
- This IS expected if you are initializing ViTForImageClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing ViTForImageClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224-in21k and are newly initialized: ['classifier.weight', 'classifier.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
***** Running training *****
  Num examples = 2600
  Num Epochs = 5
  Instantaneous batch size per device = 16
  Total train batch size (w. parallel, distributed & accumulation) = 16
  Gradient Accumulation steps = 1
  Total optimization steps = 815
  Number of trainable parameters = 87798056
  0%|          | 0/815 [00:00<?, ?it/s]  0%|          | 1/815 [00:08<2:00:26,  8.88s/it]  0%|          | 2/815 [00:20<2:24:40, 10.68s/it]  0%|          | 3/815 [00:33<2:35:52, 11.52s/it]  0%|          | 4/815 [00:46<2:43:42, 12.11s/it]  1%|          | 5/815 [00:59<2:48:18, 12.47s/it]  1%|          | 6/815 [01:11<2:46:08, 12.32s/it]  1%|          | 7/815 [01:24<2:48:23, 12.50s/it]  1%|          | 8/815 [01:35<2:44:00, 12.19s/it]  1%|          | 9/815 [01:45<2:34:00, 11.46s/it]  1%|          | 10/815 [01:54<2:24:10, 10.75s/it]                                                    1%|          | 10/815 [01:54<2:24:10, 10.75s/it]  1%|▏         | 11/815 [02:04<2:17:22, 10.25s/it]  1%|▏         | 12/815 [02:12<2:11:38,  9.84s/it]  2%|▏         | 13/815 [02:21<2:05:29,  9.39s/it]  2%|▏         | 14/815 [02:30<2:03:15,  9.23s/it]  2%|▏         | 15/815 [02:38<1:59:44,  8.98s/it]  2%|▏         | 16/815 [02:46<1:56:33,  8.75s/it]  2%|▏         | 17/815 [02:55<1:54:41,  8.62s/it]  2%|▏         | 18/815 [03:03<1:52:25,  8.46s/it]  2%|▏         | 19/815 [03:11<1:50:55,  8.36s/it]  2%|▏         | 20/815 [03:19<1:49:48,  8.29s/it]                                                    2%|▏         | 20/815 [03:19<1:49:48,  8.29s/it]  3%|▎         | 21/815 [03:27<1:48:31,  8.20s/it]  3%|▎         | 22/815 [03:35<1:47:58,  8.17s/it]  3%|▎         | 23/815 [03:44<1:50:16,  8.35s/it]  3%|▎         | 24/815 [03:52<1:49:33,  8.31s/it]  3%|▎         | 25/815 [04:00<1:48:21,  8.23s/it]  3%|▎         | 26/815 [04:09<1:49:07,  8.30s/it]  3%|▎         | 27/815 [04:17<1:48:46,  8.28s/it]  3%|▎         | 28/815 [04:25<1:48:15,  8.25s/it]  4%|▎         | 29/815 [04:33<1:47:54,  8.24s/it]  4%|▎         | 30/815 [04:42<1:51:19,  8.51s/it]                                                    4%|▎         | 30/815 [04:42<1:51:19,  8.51s/it]  4%|▍         | 31/815 [04:51<1:51:05,  8.50s/it]  4%|▍         | 32/815 [04:59<1:50:03,  8.43s/it]  4%|▍         | 33/815 [05:07<1:47:42,  8.26s/it]  4%|▍         | 34/815 [05:15<1:47:10,  8.23s/it]  4%|▍         | 35/815 [05:24<1:47:58,  8.31s/it]  4%|▍         | 36/815 [05:32<1:49:12,  8.41s/it]  5%|▍         | 37/815 [05:40<1:48:21,  8.36s/it]  5%|▍         | 38/815 [05:49<1:48:22,  8.37s/it]  5%|▍         | 39/815 [05:59<1:53:18,  8.76s/it]  5%|▍         | 40/815 [06:08<1:54:39,  8.88s/it]                                                    5%|▍         | 40/815 [06:08<1:54:39,  8.88s/it]  5%|▌         | 41/815 [06:16<1:52:36,  8.73s/it]  5%|▌         | 42/815 [06:24<1:50:32,  8.58s/it]  5%|▌         | 43/815 [06:32<1:48:32,  8.44s/it]  5%|▌         | 44/815 [06:41<1:47:39,  8.38s/it]  6%|▌         | 45/815 [06:49<1:46:10,  8.27s/it]  6%|▌         | 46/815 [06:57<1:45:47,  8.25s/it]  6%|▌         | 47/815 [07:05<1:45:35,  8.25s/it]  6%|▌         | 48/815 [07:13<1:45:26,  8.25s/it]  6%|▌         | 49/815 [07:22<1:45:20,  8.25s/it]  6%|▌         | 50/815 [07:30<1:45:54,  8.31s/it]                                                    6%|▌         | 50/815 [07:30<1:45:54,  8.31s/it]  6%|▋         | 51/815 [07:38<1:45:18,  8.27s/it]  6%|▋         | 52/815 [07:47<1:46:25,  8.37s/it]  7%|▋         | 53/815 [07:55<1:45:41,  8.32s/it]  7%|▋         | 54/815 [08:03<1:44:38,  8.25s/it]  7%|▋         | 55/815 [08:11<1:43:44,  8.19s/it]  7%|▋         | 56/815 [08:19<1:43:57,  8.22s/it]  7%|▋         | 57/815 [08:28<1:47:00,  8.47s/it]  7%|▋         | 58/815 [08:37<1:46:14,  8.42s/it]  7%|▋         | 59/815 [08:45<1:45:20,  8.36s/it]  7%|▋         | 60/815 [08:53<1:45:23,  8.38s/it]                                                    7%|▋         | 60/815 [08:53<1:45:23,  8.38s/it]  7%|▋         | 61/815 [09:03<1:50:17,  8.78s/it]  8%|▊         | 62/815 [09:12<1:51:30,  8.88s/it]  8%|▊         | 63/815 [09:21<1:49:09,  8.71s/it]  8%|▊         | 64/815 [09:29<1:47:48,  8.61s/it]  8%|▊         | 65/815 [09:37<1:47:02,  8.56s/it]  8%|▊         | 66/815 [09:46<1:46:47,  8.55s/it]  8%|▊         | 67/815 [09:54<1:45:07,  8.43s/it]  8%|▊         | 68/815 [10:03<1:46:17,  8.54s/it]  8%|▊         | 69/815 [10:11<1:43:36,  8.33s/it]  9%|▊         | 70/815 [10:21<1:50:42,  8.92s/it]                                                    9%|▊         | 70/815 [10:21<1:50:42,  8.92s/it]  9%|▊         | 71/815 [10:30<1:49:57,  8.87s/it]  9%|▉         | 72/815 [10:38<1:48:18,  8.75s/it]  9%|▉         | 73/815 [10:47<1:46:55,  8.65s/it]  9%|▉         | 74/815 [10:55<1:44:31,  8.46s/it]  9%|▉         | 75/815 [11:03<1:42:45,  8.33s/it]  9%|▉         | 76/815 [11:11<1:41:59,  8.28s/it]  9%|▉         | 77/815 [11:19<1:41:12,  8.23s/it] 10%|▉         | 78/815 [11:27<1:41:02,  8.23s/it] 10%|▉         | 79/815 [11:36<1:41:17,  8.26s/it] 10%|▉         | 80/815 [11:44<1:41:02,  8.25s/it]                                                   10%|▉         | 80/815 [11:44<1:41:02,  8.25s/it] 10%|▉         | 81/815 [11:52<1:41:30,  8.30s/it] 10%|█         | 82/815 [12:00<1:41:18,  8.29s/it] 10%|█         | 83/815 [12:09<1:40:37,  8.25s/it] 10%|█         | 84/815 [12:17<1:39:27,  8.16s/it] 10%|█         | 85/815 [12:25<1:39:51,  8.21s/it] 11%|█         | 86/815 [12:33<1:39:48,  8.21s/it] 11%|█         | 87/815 [12:42<1:42:09,  8.42s/it] 11%|█         | 88/815 [12:51<1:42:20,  8.45s/it] 11%|█         | 89/815 [13:00<1:44:33,  8.64s/it] 11%|█         | 90/815 [13:08<1:45:05,  8.70s/it]                                                   11%|█         | 90/815 [13:08<1:45:05,  8.70s/it] 11%|█         | 91/815 [13:17<1:43:16,  8.56s/it] 11%|█▏        | 92/815 [13:25<1:42:01,  8.47s/it] 11%|█▏        | 93/815 [13:33<1:40:49,  8.38s/it] 12%|█▏        | 94/815 [13:42<1:42:32,  8.53s/it] 12%|█▏        | 95/815 [13:51<1:43:43,  8.64s/it] 12%|█▏        | 96/815 [13:59<1:42:12,  8.53s/it] 12%|█▏        | 97/815 [14:07<1:41:04,  8.45s/it] 12%|█▏        | 98/815 [14:16<1:40:07,  8.38s/it] 12%|█▏        | 99/815 [14:24<1:40:28,  8.42s/it] 12%|█▏        | 100/815 [14:33<1:43:09,  8.66s/it]                                                    12%|█▏        | 100/815 [14:33<1:43:09,  8.66s/it]***** Running Evaluation *****
  Num examples = 870
  Batch size = 8
{'loss': 6.2365, 'learning_rate': 0.00019754601226993864, 'epoch': 0.06}
{'loss': 4.9282, 'learning_rate': 0.00019509202453987733, 'epoch': 0.12}
{'loss': 4.2648, 'learning_rate': 0.00019263803680981596, 'epoch': 0.18}
{'loss': 3.6769, 'learning_rate': 0.0001901840490797546, 'epoch': 0.25}
{'loss': 3.0798, 'learning_rate': 0.00018773006134969328, 'epoch': 0.31}
{'loss': 2.4748, 'learning_rate': 0.0001852760736196319, 'epoch': 0.37}
{'loss': 1.7946, 'learning_rate': 0.00018282208588957057, 'epoch': 0.43}
{'loss': 1.3752, 'learning_rate': 0.00018036809815950923, 'epoch': 0.49}
{'loss': 1.0396, 'learning_rate': 0.00017791411042944786, 'epoch': 0.55}
{'loss': 0.7442, 'learning_rate': 0.00017546012269938652, 'epoch': 0.61}

  0%|          | 0/109 [00:00<?, ?it/s][A
  2%|▏         | 2/109 [00:02<02:11,  1.23s/it][A
  3%|▎         | 3/109 [00:04<02:43,  1.54s/it][A
  4%|▎         | 4/109 [00:06<03:04,  1.76s/it][A
  5%|▍         | 5/109 [00:08<03:16,  1.89s/it][A
  6%|▌         | 6/109 [00:10<03:22,  1.97s/it][A
  6%|▋         | 7/109 [00:12<03:23,  1.99s/it][A
  7%|▋         | 8/109 [00:15<03:42,  2.20s/it][A
  8%|▊         | 9/109 [00:17<03:36,  2.17s/it][A
  9%|▉         | 10/109 [00:19<03:34,  2.17s/it][A
 10%|█         | 11/109 [00:21<03:31,  2.16s/it][A
 11%|█         | 12/109 [00:24<03:29,  2.16s/it][A
 12%|█▏        | 13/109 [00:26<03:31,  2.21s/it][A
 13%|█▎        | 14/109 [00:28<03:30,  2.21s/it][A
 14%|█▍        | 15/109 [00:30<03:24,  2.18s/it][A
 15%|█▍        | 16/109 [00:32<03:18,  2.13s/it][A
 16%|█▌        | 17/109 [00:35<03:19,  2.17s/it][A
 17%|█▋        | 18/109 [00:37<03:22,  2.23s/it][A
 17%|█▋        | 19/109 [00:39<03:18,  2.20s/it][A
 18%|█▊        | 20/109 [00:41<03:17,  2.22s/it][A
 19%|█▉        | 21/109 [00:43<03:14,  2.21s/it][A
 20%|██        | 22/109 [00:46<03:12,  2.22s/it][A
 21%|██        | 23/109 [00:48<03:06,  2.17s/it][A
 22%|██▏       | 24/109 [00:50<03:08,  2.22s/it][A
 23%|██▎       | 25/109 [00:52<03:01,  2.16s/it][A
 24%|██▍       | 26/109 [00:54<02:55,  2.11s/it][A
 25%|██▍       | 27/109 [00:56<02:44,  2.01s/it][A
 26%|██▌       | 28/109 [00:58<02:49,  2.10s/it][A
 27%|██▋       | 29/109 [01:01<02:57,  2.22s/it][A
 28%|██▊       | 30/109 [01:03<02:55,  2.22s/it][A
 28%|██▊       | 31/109 [01:05<02:54,  2.23s/it][A
 29%|██▉       | 32/109 [01:07<02:51,  2.23s/it][A
 30%|███       | 33/109 [01:09<02:41,  2.13s/it][A
 31%|███       | 34/109 [01:12<02:43,  2.18s/it][A
 32%|███▏      | 35/109 [01:14<02:41,  2.18s/it][A
 33%|███▎      | 36/109 [01:16<02:49,  2.32s/it][A
 34%|███▍      | 37/109 [01:19<02:50,  2.37s/it][A
 35%|███▍      | 38/109 [01:21<02:43,  2.31s/it][A
 36%|███▌      | 39/109 [01:23<02:43,  2.34s/it][A
 37%|███▋      | 40/109 [01:26<02:36,  2.27s/it][A
 38%|███▊      | 41/109 [01:28<02:36,  2.30s/it][A
 39%|███▊      | 42/109 [01:30<02:31,  2.27s/it][A
 39%|███▉      | 43/109 [01:32<02:26,  2.22s/it][A
 40%|████      | 44/109 [01:35<02:25,  2.24s/it][A
 41%|████▏     | 45/109 [01:37<02:21,  2.21s/it][A
 42%|████▏     | 46/109 [01:39<02:17,  2.18s/it][A
 43%|████▎     | 47/109 [01:41<02:14,  2.17s/it][A
 44%|████▍     | 48/109 [01:43<02:11,  2.15s/it][A
 45%|████▍     | 49/109 [01:45<02:05,  2.09s/it][A
 46%|████▌     | 50/109 [01:47<02:02,  2.08s/it][A
 47%|████▋     | 51/109 [01:49<02:00,  2.08s/it][A
 48%|████▊     | 52/109 [01:51<02:03,  2.16s/it][A
 49%|████▊     | 53/109 [01:54<02:14,  2.40s/it][A
 50%|████▉     | 54/109 [01:57<02:18,  2.51s/it][A
 50%|█████     | 55/109 [01:59<02:10,  2.41s/it][A
 51%|█████▏    | 56/109 [02:02<02:03,  2.33s/it][A
 52%|█████▏    | 57/109 [02:04<01:56,  2.23s/it][A
 53%|█████▎    | 58/109 [02:06<01:51,  2.20s/it][A
 54%|█████▍    | 59/109 [02:08<01:46,  2.12s/it][A
 55%|█████▌    | 60/109 [02:10<01:42,  2.10s/it][A
 56%|█████▌    | 61/109 [02:12<01:39,  2.08s/it][A
 57%|█████▋    | 62/109 [02:14<01:37,  2.08s/it][A
 58%|█████▊    | 63/109 [02:16<01:37,  2.11s/it][A
 59%|█████▊    | 64/109 [02:18<01:35,  2.13s/it][A
 60%|█████▉    | 65/109 [02:20<01:29,  2.05s/it][A
 61%|██████    | 66/109 [02:23<01:35,  2.21s/it][A
 61%|██████▏   | 67/109 [02:25<01:32,  2.20s/it][A
 62%|██████▏   | 68/109 [02:27<01:28,  2.17s/it][A
 63%|██████▎   | 69/109 [02:29<01:32,  2.32s/it][A
 64%|██████▍   | 70/109 [02:33<01:40,  2.58s/it][A
 65%|██████▌   | 71/109 [02:36<01:41,  2.66s/it][A
 66%|██████▌   | 72/109 [02:39<01:42,  2.76s/it][A
 67%|██████▋   | 73/109 [02:41<01:34,  2.63s/it][A
 68%|██████▊   | 74/109 [02:43<01:26,  2.48s/it][A
 69%|██████▉   | 75/109 [02:45<01:19,  2.35s/it][A
 70%|██████▉   | 76/109 [02:47<01:15,  2.30s/it][A
 71%|███████   | 77/109 [02:49<01:11,  2.24s/it][A
 72%|███████▏  | 78/109 [02:52<01:09,  2.24s/it][A
 72%|███████▏  | 79/109 [02:54<01:08,  2.28s/it][A
 73%|███████▎  | 80/109 [02:56<01:06,  2.28s/it][A
 74%|███████▍  | 81/109 [03:00<01:14,  2.64s/it][A
 75%|███████▌  | 82/109 [03:02<01:08,  2.52s/it][A
 76%|███████▌  | 83/109 [03:04<01:02,  2.39s/it][A
 77%|███████▋  | 84/109 [03:06<00:57,  2.30s/it][A
 78%|███████▊  | 85/109 [03:08<00:52,  2.17s/it][A
 79%|███████▉  | 86/109 [03:10<00:49,  2.13s/it][A
 80%|███████▉  | 87/109 [03:12<00:45,  2.07s/it][A
 81%|████████  | 88/109 [03:14<00:43,  2.06s/it][A
 82%|████████▏ | 89/109 [03:16<00:42,  2.12s/it][A
 83%|████████▎ | 90/109 [03:18<00:39,  2.07s/it][A
 83%|████████▎ | 91/109 [03:20<00:35,  2.00s/it][A
 84%|████████▍ | 92/109 [03:22<00:34,  2.03s/it][A
 85%|████████▌ | 93/109 [03:24<00:33,  2.11s/it][A
 86%|████████▌ | 94/109 [03:26<00:31,  2.07s/it][A
 87%|████████▋ | 95/109 [03:29<00:29,  2.11s/it][A
 88%|████████▊ | 96/109 [03:31<00:27,  2.13s/it][A
 89%|████████▉ | 97/109 [03:33<00:25,  2.13s/it][A
 90%|████████▉ | 98/109 [03:35<00:24,  2.21s/it][A
 91%|█████████ | 99/109 [03:37<00:21,  2.17s/it][A
 92%|█████████▏| 100/109 [03:40<00:20,  2.32s/it][A
 93%|█████████▎| 101/109 [03:42<00:18,  2.36s/it][A
 94%|█████████▎| 102/109 [03:45<00:16,  2.34s/it][A
 94%|█████████▍| 103/109 [03:47<00:13,  2.29s/it][A
 95%|█████████▌| 104/109 [03:49<00:11,  2.29s/it][A
 96%|█████████▋| 105/109 [03:51<00:09,  2.27s/it][A
 97%|█████████▋| 106/109 [03:54<00:06,  2.28s/it][A
 98%|█████████▊| 107/109 [03:56<00:04,  2.18s/it][A
 99%|█████████▉| 108/109 [03:58<00:02,  2.19s/it][A
100%|██████████| 109/109 [03:59<00:00,  2.00s/it][A
                                                 [A                                                   
100%|██████████| 109/109 [04:00<00:00,  2.00s/it][A 12%|█▏        | 100/815 [18:36<1:43:09,  8.66s/it]
                                                 [ASaving model checkpoint to ../checkpoint-100
Configuration saved in ../checkpoint-100/config.json
Model weights saved in ../checkpoint-100/pytorch_model.bin
Image processor saved in ../checkpoint-100/preprocessor_config.json
Deleting older checkpoint [../checkpoint-200] due to args.save_total_limit
 12%|█▏        | 101/815 [18:45<16:10:17, 81.54s/it] 13%|█▎        | 102/815 [18:54<11:49:02, 59.67s/it] 13%|█▎        | 103/815 [19:02<8:45:19, 44.27s/it]  13%|█▎        | 104/815 [19:10<6:37:40, 33.56s/it] 13%|█▎        | 105/815 [19:22<5:18:24, 26.91s/it] 13%|█▎        | 106/815 [19:30<4:11:19, 21.27s/it] 13%|█▎        | 107/815 [19:38<3:25:18, 17.40s/it] 13%|█▎        | 108/815 [19:48<2:58:07, 15.12s/it] 13%|█▎        | 109/815 [19:57<2:34:22, 13.12s/it] 13%|█▎        | 110/815 [20:05<2:16:37, 11.63s/it]                                                    13%|█▎        | 110/815 [20:05<2:16:37, 11.63s/it] 14%|█▎        | 111/815 [20:18<2:23:49, 12.26s/it] 14%|█▎        | 112/815 [20:27<2:09:09, 11.02s/it] 14%|█▍        | 113/815 [20:36<2:03:51, 10.59s/it]